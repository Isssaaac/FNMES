@using Microsoft.Extensions.Localization
@using FNMES.WebUI;

@inject IStringLocalizer<SharedResource> SharedLocalizer﻿

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@Html.Raw(@SharedLocalizer["ChangePassword"])</title>
    <link href="~/Content/layui/css/layui.css" rel="stylesheet" />
    <!--[if lt IE 9]>
        <script src="/Content/jquery/jquery-1.9.1.min.js"></script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
    <script src="~/Content/jquery/jquery.min.js"></script>
    <!--<![endif]-->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="~/Content/jquery/jquery.md5.js"></script>
    <script src="~/Content/layui/layui.js"></script>
    <script src="~/Content/framework/js/global.js"></script>
</head>
<body>
    <form id="modifyPwdForm" class="layui-form layui-form-pane" style="margin: 30px;">
        <div class="layui-form-item">
            <label class="layui-form-label">@SharedLocalizer﻿["OldPassword"]</label>
            <div class="layui-input-block">
                <input type="password" name="oldPassword" lay-verify="password" autocomplete="off" placeholder="@SharedLocalizer﻿["Please enter the old password"]" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">@SharedLocalizer﻿["NewPassword"]</label>
            <div class="layui-input-block">
                <input type="password" name="newPassword" lay-verify="password" autocomplete="off" placeholder="@SharedLocalizer["Please enter the new password"]" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">@SharedLocalizer﻿["ConfirmPassword"]</label>
            <div class="layui-input-block">
                <input type="password" name="confirmPassword" lay-verify="password" autocomplete="off" placeholder="@SharedLocalizer["Please confirm the new password"]" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn layui-btn-normal" lay-filter="savePwd" lay-submit>@SharedLocalizer["Save"]</button>
                <button id="btnReset" class="layui-btn layui-btn-danger" type="reset">@SharedLocalizer["Reset"]</button>
            </div>
        </div>
    </form>
</body>
</html>

<script type="text/javascript">
    layui.use(['form'], function () {
        var form = layui.form;
        form.verify({
            password: [/^[A-Za-z0-9._-]{6,16}$/, '@Html.Raw(@SharedLocalizer["The password must be between 6 and 16 bits and must not contain special characters."])']
        });
        form.on('submit(savePwd)', function (data) {
            data.field.oldPassword = $.md5(data.field.oldPassword);
            data.field.newPassword = $.md5(data.field.newPassword);
            data.field.confirmPassword = $.md5(data.field.confirmPassword);
            $.formSubmit({
                url: "/account/modifyPwd",
                data: data.field,
                close: false
            });
            return false;
        });
    });
</script>
